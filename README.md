# de-dbt-adventureworks  
End-to-end dbt project on **SQL Server (AdventureWorksDW)** with staging, intermediate, marts, tests, snapshots, CI, and a companion **Power BI Pareto analysis** dashboard.

This repo is designed as a **portfolio-friendly project** to demonstrate professional data engineering patterns using dbt Core on SQL Server.

---

# ğŸ” Project Overview

This repository implements:

- A clean **staging â†’ intermediate â†’ marts** layer structure  
- **Incremental models** with `unique_key` on SQL Server  
- A **dbt snapshot** (Type 2 SCD)  
- A **custom generic data test**  
- **Column-level documentation** and autogenerated dbt docs  
- **CI workflow** using GitHub Actions (`dbt parse` + `sqlfluff`)  
- A full **Pareto sales analysis** in dbt + Power BI  

The project uses Microsoftâ€™s public **AdventureWorksDW** dataset.

---

# âœ”ï¸ Proof Checklist

_(For recruiters & reviewers)_

- [x] Staging models with data tests  
- [x] Freshness checks in `_sources.yml`  
- [x] Intermediate models combining multiple fact tables  
- [x] Incremental model with `unique_key`  
- [x] Custom generic test: `percent_nulls_under_threshold`  
- [x] Snapshot (`customer_snapshot`)  
- [x] Exposure linking dbt â†’ Power BI  
- [x] CI workflow running dbt + SQLFluff  

---

# ğŸ“Š Pareto Sales Analysis (dbt + Power BI)

This repo includes a complete side project showing how to go from raw operational data to a **fully analytics-ready mart** and a **Pareto dashboard**.

### **Business question**
> **Which products drive 80% of total company revenue, and how is that revenue distributed by category?**

### **Pipeline summary**

#### ğŸ—‚ï¸ Staging  
- `stg_fact_internet_sales`  
- `stg_fact_reseller_sales`  
- `stg_dim_product`  
- `stg_dim_product_subcategory`  
(standardized column names, cleaned types, removed unused fields)

#### ğŸ”„ Intermediate  
- `int_tot_sales_fact`  
  - Combines Internet + Reseller sales  
  - Unified revenue metric  
  - Product keys + category keys  
  - Channel indicators  

#### ğŸ“¦ Mart  
- `fct_sales_pareto`  
  - Product-level revenue  
  - Rank by descending sales  
  - Running cumulative total  
  - Cumulative share of company-wide sales  
  - 80% cutoff flag  

All Pareto logic is computed in **dbt SQL**, not in Power BI.

---

# ğŸ“ˆ Power BI Dashboard

A one-page dashboard built directly on top of the mart `fct_sales_pareto`.

It includes:

- KPI cards (total share covered, product count, category count)  
- Treemap of top product categories  
- Horizontal bar chart of top products  
- Detailed product table  
- **Pareto curve** (bars = sales, line = cumulative %)

ğŸ“· _Screenshot available in `/docs/pareto_bi_report.png`_  

## Comments
AdventureWorksDW2022 is a static demo DB with last orders in 2014. Freshness is configured with a very wide window so that dbt can still demonstrate freshness checks without constantly flagging the sample data as stale
